{% extends 'base.html' %}

{% block title %}–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ - –û—Å—Ç—Ä–æ–≤{% endblock %}

{% block extra_css %}
<style>
    .success-icon {
        font-size: 80px;
        color: #28a745;
        margin-bottom: 20px;
        animation: scaleIn 0.5s ease;
    }
    @keyframes scaleIn {
        0% { transform: scale(0); }
        70% { transform: scale(1.2); }
        100% { transform: scale(1); }
    }
    .building-details {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 30px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    }
    .detail-row {
        display: flex;
        justify-content: space-between;
        padding: 15px;
        border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    .detail-row:last-child {
        border-bottom: none;
    }
    .detail-label {
        font-size: 1.1rem;
        opacity: 0.9;
    }
    .detail-value {
        font-size: 1.3rem;
        font-weight: bold;
    }
    .building-icon {
        font-size: 48px;
        margin-bottom: 15px;
    }
    .price-tag {
        background: rgba(255,255,255,0.2);
        padding: 10px 20px;
        border-radius: 50px;
        display: inline-block;
        font-size: 1.2rem;
    }
    .info-card {
        transition: all 0.3s;
        border: none;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        height: 100%;
    }
    .info-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    .checkmark {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: #28a745;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 50px;
        margin: 0 auto 20px;
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0.7); }
        70% { box-shadow: 0 0 0 20px rgba(40, 167, 69, 0); }
        100% { box-shadow: 0 0 0 0 rgba(40, 167, 69, 0); }
    }
    .owner-badge {
        background: #17a2b8;
        color: white;
        padding: 5px 15px;
        border-radius: 25px;
        font-size: 1rem;
        display: inline-block;
    }
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin-top: 20px;
    }
    .stat-box {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }
    .stat-number {
        font-size: 1.8rem;
        font-weight: bold;
        color: #28a745;
    }
    .stat-label {
        font-size: 0.9rem;
        color: #6c757d;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <!-- –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ -->
            <div class="text-center mb-4">
                <div class="checkmark">
                    <i class="bi bi-check-lg"></i>
                </div>
                <h1 class="display-4">–ó–¥–∞–Ω–∏–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–æ!</h1>
                <p class="lead text-muted">–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</p>
            </div>

            <!-- –î–µ—Ç–∞–ª–∏ –ø–æ—Å—Ç—Ä–æ–π–∫–∏ -->
            <div class="building-details text-center">
                <div class="building-icon">
                    {% if '—Ñ–∞–±—Ä–∏–∫' in build.building|lower %}
                        üè≠
                    {% elif '–º–∞–≥–∞–∑–∏–Ω' in build.building|lower or '—Ç–∞–≤–µ—Ä–Ω' in build.building|lower or '—Ä–µ—Å—Ç–æ—Ä–∞–Ω' in build.building|lower or '–≥–æ—Å—Ç–∏–Ω–∏—Ü' in build.building|lower %}
                        üè™
                    {% elif '–¥–æ–º' in build.building|lower or '–æ—Å–æ–±–Ω—è–∫' in build.building|lower %}
                        üè†
                    {% elif '—Å–∫–ª–∞–¥' in build.building|lower %}
                        üì¶
                    {% elif '—Ñ–µ—Ä–º' in build.building|lower or '–ø–ª–∞–Ω—Ç–∞—Ü' in build.building|lower %}
                        üåæ
                    {% else %}
                        üèóÔ∏è
                    {% endif %}
                </div>
                
                <h2 class="mb-4">{{ build.building }}</h2>
                
                <div class="price-tag mb-4">
                    <i class="bi bi-coin"></i> –°—Ç–æ–∏–º–æ—Å—Ç—å: {{ build.cost }} ‚ÇΩ
                </div>
                
                <div class="owner-badge mb-4">
                    <i class="bi bi-person"></i> –í–ª–∞–¥–µ–ª–µ—Ü: –ò–≥—Ä–æ–∫ #{{ build.player_id }}
                </div>
                
                <div class="detail-row">
                    <span class="detail-label">–î–∞—Ç–∞ –ø–æ—Å—Ç—Ä–æ–π–∫–∏:</span>
                    <span class="detail-value">{% now "d.m.Y H:i" %}</span>
                </div>
                
                <div class="detail-row">
                    <span class="detail-label">–ü–æ—Å—Ç—Ä–æ–∏–ª:</span>
                    <span class="detail-value">{{ request.session.username|default:'–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä' }}</span>
                </div>
                
                <div class="detail-row">
                    <span class="detail-label">–ù–æ–º–µ—Ä –∑–∞–ø–∏—Å–∏:</span>
                    <span class="detail-value">#{{ build.id|default:'–ù–æ–≤—ã–π' }}</span>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–≥—Ä–æ–∫–∞ -->
            <div class="stats-grid mb-4">
                <div class="stat-box">
                    <div class="stat-number">{{ player_buildings|default:'0' }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ –ø–æ—Å—Ç—Ä–æ–µ–∫</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{ player_businesses|default:'0' }}</div>
                    <div class="stat-label">–ë–∏–∑–Ω–µ—Å–æ–≤</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{ player_factories|default:'0' }}</div>
                    <div class="stat-label">–§–∞–±—Ä–∏–∫</div>
                </div>
            </div>

            <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="row">
                <div class="col-md-6 mb-3">
                    <div class="card info-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-lightbulb text-warning"></i>
                                –ß—Ç–æ –¥–∞–ª—å—à–µ?
                            </h5>
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success"></i>
                                    –ó–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success"></i>
                                    –ú–æ–∂–Ω–æ –Ω–∞—á–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-check-circle text-success"></i>
                                    –ü—Ä–∏–±—ã–ª—å –±—É–¥–µ—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="col-md-6 mb-3">
                    <div class="card info-card">
                        <div class="card-body">
                            <h5 class="card-title">
                                <i class="bi bi-graph-up text-primary"></i>
                                –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
                            </h5>
                            <ul class="list-unstyled">
                                <li class="mb-2">
                                    <i class="bi bi-arrow-up text-success"></i>
                                    –î–æ—Ö–æ–¥: {% if '—Ñ–∞–±—Ä–∏–∫' in build.building|lower %}50/—Ö–æ–¥{% elif '–±–∏–∑–Ω–µ—Å' in build.building|lower %}5 ‚ÇΩ/–º–∏–Ω{% else %}‚Äî{% endif %}
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-people text-info"></i>
                                    –†–∞–±–æ—á–∏—Ö: {% if '—Ñ–∞–±—Ä–∏–∫' in build.building|lower %}10{% elif '–±–∏–∑–Ω–µ—Å' in build.building|lower %}3{% else %}0{% endif %}
                                </li>
                                <li class="mb-2">
                                    <i class="bi bi-box text-secondary"></i>
                                    –í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: {% if '—Å–∫–ª–∞–¥' in build.building|lower %}500{% else %}100{% endif %}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="row mt-4">
                <div class="col-md-4 mb-2">
                    <a href="{% url 'island_build' %}" class="btn btn-success btn-lg w-100">
                        <i class="bi bi-plus-circle"></i> –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –µ—â–µ
                    </a>
                </div>
                <div class="col-md-4 mb-2">
                    <a href="{% url 'island_dashboard' %}" class="btn btn-primary btn-lg w-100">
                        <i class="bi bi-tree"></i> –ù–∞ –û—Å—Ç—Ä–æ–≤
                    </a>
                </div>
                <div class="col-md-4 mb-2">
                    
                </div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥ -->
            <div class="card mt-4 bg-light">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-info-circle-fill text-info fs-3 me-3"></i>
                        <div>
                            <h6 class="mb-1">–ó–∞–ø–∏—Å—å –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ –ª–æ–≥ –æ–ø–µ—Ä–∞—Ü–∏–π</h6>
                            <p class="text-muted mb-0">
                                –í—Ä–µ–º—è: {% now "d.m.Y H:i:s" %} | 
                                –ê–≤—Ç–æ—Ä: {{ request.session.username }} | 
                                –¢–∏–ø: –ü–æ—Å—Ç—Ä–æ–π–∫–∞ –∑–¥–∞–Ω–∏—è
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) -->
{% if auto_redirect %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    const elements = document.querySelectorAll('.building-details, .stats-grid, .info-card, .btn');
    elements.forEach((el, index) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            el.style.transition = 'all 0.5s ease';
            el.style.opacity = '1';
            el.style.transform = 'translateY(0)';
        }, 100 * index);
    });
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
    let secondsLeft = 10;
    const timerElement = document.createElement('div');
    timerElement.className = 'text-center mt-3 text-muted';
    timerElement.innerHTML = `–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ—Ö–æ–¥ —á–µ—Ä–µ–∑ <span id="timer">${secondsLeft}</span> —Å–µ–∫—É–Ω–¥...`;
    
    const container = document.querySelector('.row.justify-content-center .col-md-8');
    container.appendChild(timerElement);
    
    const timer = setInterval(() => {
        secondsLeft--;
        const timerSpan = document.getElementById('timer');
        if (timerSpan) {
            timerSpan.textContent = secondsLeft;
        }
        
        if (secondsLeft <= 0) {
            clearInterval(timer);
            window.location.href = "{% url 'island_dashboard' %}";
        }
    }, 1000);
    
    // –û—Ç–º–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞ –ø—Ä–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏
    document.addEventListener('click', function() {
        clearInterval(timer);
        if (timerElement) {
            timerElement.style.display = 'none';
        }
    }, { once: true });
});
</script>
{% endif %}
{% endblock %}