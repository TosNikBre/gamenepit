{% extends 'base.html' %}

{% block title %}–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–Ω–æ—Å–∞ - –û—Å—Ç—Ä–æ–≤{% endblock %}

{% block extra_css %}
<style>
    .warning-icon {
        font-size: 80px;
        color: #dc3545;
        margin-bottom: 20px;
        animation: pulse 2s infinite;
    }
    @keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }
    .building-details {
        background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        color: white;
        padding: 30px;
        border-radius: 15px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(220, 53, 69, 0.3);
    }
    .detail-row {
        display: flex;
        justify-content: space-between;
        padding: 15px;
        border-bottom: 1px solid rgba(255,255,255,0.2);
    }
    .detail-row:last-child {
        border-bottom: none;
    }
    .detail-label {
        font-size: 1.1rem;
        opacity: 0.9;
    }
    .detail-value {
        font-size: 1.3rem;
        font-weight: bold;
    }
    .building-icon {
        font-size: 48px;
        margin-bottom: 15px;
    }
    .compensation-box {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        color: white;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        margin: 20px 0;
        animation: glow 2s infinite;
    }
    @keyframes glow {
        0% { box-shadow: 0 0 5px rgba(40, 167, 69, 0.5); }
        50% { box-shadow: 0 0 20px rgba(40, 167, 69, 0.8); }
        100% { box-shadow: 0 0 5px rgba(40, 167, 69, 0.5); }
    }
    .compensation-amount {
        font-size: 3rem;
        font-weight: bold;
        line-height: 1.2;
    }
    .warning-text {
        color: #dc3545;
        font-weight: bold;
        font-size: 1.2rem;
    }
    .info-card {
        transition: all 0.3s;
        border: none;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        height: 100%;
    }
    .info-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    .checkmark {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: #28a745;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 30px;
        margin: 0 auto 15px;
    }
    .owner-badge {
        background: rgba(255,255,255,0.2);
        padding: 8px 20px;
        border-radius: 30px;
        display: inline-block;
        font-size: 1.1rem;
    }
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
        margin: 20px 0;
    }
    .stat-box {
        background: #f8f9fa;
        padding: 15px;
        border-radius: 10px;
        text-align: center;
    }
    .stat-number {
        font-size: 1.5rem;
        font-weight: bold;
        color: #dc3545;
    }
    .stat-label {
        font-size: 0.9rem;
        color: #6c757d;
    }
    .confirm-checkbox {
        transform: scale(1.2);
        margin-right: 10px;
    }
    .confirm-label {
        font-size: 1.1rem;
        color: #dc3545;
        font-weight: 500;
    }
</style>
{% endblock %}

{% block content %}
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ -->
            <div class="text-center mb-4">
                <div class="warning-icon">
                    <i class="bi bi-exclamation-triangle-fill"></i>
                </div>
                <h1 class="display-4 text-danger">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å–Ω–æ—Å–∞</h1>
                <p class="lead text-muted">–≠—Ç–∞ –æ–ø–µ—Ä–∞—Ü–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞</p>
            </div>

            <!-- –î–µ—Ç–∞–ª–∏ —Å–Ω–æ—Å–∞ -->
            <div class="building-details text-center">
                <div class="building-icon">
                    {% if '—Ñ–∞–±—Ä–∏–∫' in demolish.name|lower %}
                        üè≠
                    {% elif '–º–∞–≥–∞–∑–∏–Ω' in demolish.name|lower or '—Ç–∞–≤–µ—Ä–Ω' in demolish.name|lower or '—Ä–µ—Å—Ç–æ—Ä–∞–Ω' in demolish.name|lower or '–≥–æ—Å—Ç–∏–Ω–∏—Ü' in demolish.name|lower %}
                        üè™
                    {% elif '–¥–æ–º' in demolish.name|lower or '–æ—Å–æ–±–Ω—è–∫' in demolish.name|lower %}
                        üè†
                    {% elif '—Å–∫–ª–∞–¥' in demolish.name|lower %}
                        üì¶
                    {% elif '—Ñ–µ—Ä–º' in demolish.name|lower or '–ø–ª–∞–Ω—Ç–∞—Ü' in demolish.name|lower %}
                        üåæ
                    {% else %}
                        üèóÔ∏è
                    {% endif %}
                </div>
                
                <h2 class="mb-3">{{ demolish.name }}</h2>
                
                <div class="owner-badge mb-4">
                    <i class="bi bi-person"></i> –í–ª–∞–¥–µ–ª–µ—Ü: –ò–≥—Ä–æ–∫ #{{ demolish.owner }}
                </div>
                
                <div class="detail-row">
                    <span class="detail-label">–¢–∏–ø –∑–¥–∞–Ω–∏—è:</span>
                    <span class="detail-value">
                        {% if demolish.type == 'business' %}–ë–∏–∑–Ω–µ—Å
                        {% elif demolish.type == 'factory' %}–§–∞–±—Ä–∏–∫–∞
                        {% elif demolish.type == 'residential' %}–ñ–∏–ª–æ–π –¥–æ–º
                        {% else %}–î—Ä—É–≥–æ–µ{% endif %}
                    </span>
                </div>
                
                <div class="detail-row">
                    <span class="detail-label">–°—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Å—Ç—Ä–æ–π–∫–∏:</span>
                    <span class="detail-value">{{ demolish.cost }} ‚ÇΩ</span>
                </div>
                
                <div class="detail-row">
                    <span class="detail-label">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å —Å–Ω–æ—Å–∞:</span>
                    <span class="detail-value">–ò–≥—Ä–æ–∫ #{{ demolish.demolisher }}</span>
                </div>
                
                <div class="detail-row">
                    <span class="detail-label">–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è:</span>
                    <span class="detail-value">{% now "d.m.Y H:i:s" %}</span>
                </div>
            </div>

            <!-- –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –¥–ª—è –±–∏–∑–Ω–µ—Å–∞ -->
            {% if demolish.type == 'business' and demolish.accumulated > 0 %}
            <div class="compensation-box">
                <div class="checkmark mx-auto">
                    <i class="bi bi-cash"></i>
                </div>
                <h4>–ù–∞–∫–æ–ø–ª–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –∫ –≤—ã–¥–∞—á–µ</h4>
                <div class="compensation-amount">{{ demolish.accumulated }} ‚ÇΩ</div>
                <p class="mt-3 mb-0">
                    <i class="bi bi-info-circle"></i>
                    –≠—Ç—É —Å—É–º–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–¥–∞—Ç—å –≤–ª–∞–¥–µ–ª—å—Ü—É –∑–¥–∞–Ω–∏—è
                </p>
            </div>
            {% endif %}

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-number">{{ stats.total_demolitions|default:'0' }}</div>
                    <div class="stat-label">–í—Å–µ–≥–æ —Å–Ω–æ—Å–æ–≤</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{ stats.demolitions_today|default:'0' }}</div>
                    <div class="stat-label">–ó–∞ —Å–µ–≥–æ–¥–Ω—è</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">{{ stats.total_compensation|default:'0' }} ‚ÇΩ</div>
                    <div class="stat-label">–í—ã–ø–ª–∞—á–µ–Ω–æ</div>
                </div>
            </div>

            <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ -->
            <div class="card mb-4 border-danger">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0"><i class="bi bi-exclamation-triangle"></i> –í–Ω–∏–º–∞–Ω–∏–µ!</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-danger">
                        <strong>–û–ø–µ—Ä–∞—Ü–∏—è –Ω–µ–æ–±—Ä–∞—Ç–∏–º–∞!</strong> –ó–¥–∞–Ω–∏–µ –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–≥—Ä—ã.
                        {% if demolish.type == 'business' and demolish.accumulated > 0 %}
                        <br>–ù–µ –∑–∞–±—É–¥—å—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—É—é –ø—Ä–∏–±—ã–ª—å –≤–ª–∞–¥–µ–ª—å—Ü—É.
                        {% endif %}
                    </div>

                    <form method="post" id="confirmForm">
                        {% csrf_token %}
                        
                        <div class="form-check mb-3">
                            <input class="form-check-input confirm-checkbox" type="checkbox" id="confirmCheck">
                            <label class="form-check-label confirm-label" for="confirmCheck">
                                –Ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é, —á—Ç–æ —Ö–æ—á—É —Å–Ω–µ—Å—Ç–∏ —ç—Ç–æ –∑–¥–∞–Ω–∏–µ
                            </label>
                        </div>
                        
                        <div class="d-flex justify-content-end gap-2">
                            <a href="{% url 'island_demolish' %}" class="btn btn-secondary btn-lg">
                                <i class="bi bi-arrow-left"></i> –ù–∞–∑–∞–¥
                            </a>
                            <button type="submit" class="btn btn-danger btn-lg" id="submitBtn" disabled>
                                <i class="bi bi-building-slash"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —Å–Ω–æ—Å
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–ø–∏—Å–∏ –≤ –ª–æ–≥ -->
            <div class="card bg-light">
                <div class="card-body">
                    <div class="d-flex align-items-center">
                        <i class="bi bi-info-circle-fill text-info fs-3 me-3"></i>
                        <div>
                            <h6 class="mb-1">–û–ø–µ—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–ø–∏—Å–∞–Ω–∞ –≤ –ª–æ–≥</h6>
                            <p class="text-muted mb-0">
                                –í—Ä–µ–º—è: {% now "d.m.Y H:i:s" %} | 
                                –ê–≤—Ç–æ—Ä: {{ request.session.username }} | 
                                –¢–∏–ø: –°–Ω–æ—Å –∑–¥–∞–Ω–∏—è
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const confirmCheck = document.getElementById('confirmCheck');
    const submitBtn = document.getElementById('submitBtn');
    
    confirmCheck.addEventListener('change', function() {
        submitBtn.disabled = !this.checked;
    });
    
    // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
    const elements = document.querySelectorAll('.building-details, .compensation-box, .stats-grid, .card');
    elements.forEach((el, index) => {
        el.style.opacity = '0';
        el.style.transform = 'translateY(20px)';
        
        setTimeout(() => {
            el.style.transition = 'all 0.5s ease';
            el.style.opacity = '1';
            el.style.transform = 'translateY(0)';
        }, 100 * index);
    });
});
</script>
{% endblock %}